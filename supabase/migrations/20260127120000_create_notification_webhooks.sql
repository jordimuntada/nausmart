-- =====================================================
-- DATABASE WEBHOOKS FOR REALBRAVE NOTIFICATIONS
-- =====================================================
-- 
-- IMPORTANT: Database webhooks must be created via the Supabase Dashboard
-- because the pg_net extension and supabase_functions schema are not 
-- available in this project by default.
--
-- Follow these steps to create the webhooks:
--
-- =====================================================
-- STEP 1: Go to Supabase Dashboard
-- =====================================================
-- URL: https://supabase.com/dashboard/project/ofqxvygsjneccemymtws/integrations/webhooks
--
-- =====================================================
-- STEP 2: Create Webhook for Contact Forms
-- =====================================================
-- Click "Create a new hook" and configure:
--   • Name: notify-contactforms
--   • Table: Realbrave-contactforms (public schema)
--   • Events: Insert ✓
--   • Type: Supabase Edge Functions
--   • Edge Function: notify-contactforms
--   • Method: POST
--   • Timeout: 5000
--   • HTTP Headers:
--     - Content-Type: application/json
--     - Authorization: (click "Add auth header with service key")
--
-- =====================================================
-- STEP 3: Create Webhook for Community Signups
-- =====================================================
-- Click "Create a new hook" and configure:
--   • Name: notify-realbrave  
--   • Table: realbrave (public schema)
--   • Events: Insert ✓
--   • Type: Supabase Edge Functions
--   • Edge Function: notify-realbrave
--   • Method: POST
--   • Timeout: 5000
--   • HTTP Headers:
--     - Content-Type: application/json
--     - Authorization: (click "Add auth header with service key")
--
-- =====================================================
-- STEP 4: Deploy Edge Functions (if not deployed)
-- =====================================================
-- Run these commands to deploy the edge functions:
--
-- supabase functions deploy notify-contactforms --project-ref ofqxvygsjneccemymtws
-- supabase functions deploy notify-realbrave --project-ref ofqxvygsjneccemymtws
-- supabase functions deploy community-signup --project-ref ofqxvygsjneccemymtws
--
-- =====================================================
-- STEP 5: Set Environment Variables for Edge Functions
-- =====================================================
-- In Supabase Dashboard > Edge Functions > Settings, set:
--
-- For Email (Resend):
--   RESEND_API_KEY=your_resend_api_key
--   FROM_EMAIL=notifications@yourdomain.com
--   TO_EMAIL=admin@canmirgestions.com
--
-- For SMS (Twilio):
--   TWILIO_ACCOUNT_SID=your_twilio_sid
--   TWILIO_AUTH_TOKEN=your_twilio_token
--   TWILIO_PHONE_NUMBER=+1234567890
--   ADMIN_PHONE_NUMBER=+34930107830
--
-- =====================================================
-- WEBHOOK PAYLOAD FORMAT (Auto-generated by Supabase)
-- =====================================================
-- {
--   "type": "INSERT",
--   "table": "Realbrave-contactforms",
--   "schema": "public",
--   "record": { ...new row data... },
--   "old_record": null
-- }
--
-- =====================================================

-- This migration is documentation only - no SQL to execute
SELECT 'Database webhooks must be created via Supabase Dashboard' AS instruction;
